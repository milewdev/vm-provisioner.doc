<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8" />
    <title>vm-provisioner</title>
    <link rel="stylesheet" href="stylesheets/style.css" />
  </head>

  <body>
    <header>
      <nav>
        <menu>
          <menuitem><a href='index.html'>Home</a></menuitem>
        </menu>
        <menu>
          <menuitem><a href='https://github.com/milewdev'>GitHub</a></menuitem>
          <menuitem><a href='mailto:milewdev@gmail.com'>Contact</a></menuitem>
        </menu>
      </nav>
    </header>

    <div class='lr-crumple-zone'>
      <div class='lr-crumple-zone-inner'>
        <section class='index'>
          <nav>
            <h1>User Guide</h1>
            <ul>
              <li><a href='#Overview'>Overview</a></li>
              <li><a href='#Installation'>Installation</a></li>
              <li><a href='#Quickstart'>Quickstart</a></li>
              <li>
                <a href='#Reference'>Reference</a>
                <ul>
                  <li><a href='#add_to_path'>add_to_path</a></li>
                  <li><a href='#bundle_install'>bundle_install</a></li>
                  <li><a href='#cd'>cd</a></li>
                  <li><a href='#git_clone'>git_clone</a></li>
                  <li><a href='#install_atom'>install_atom</a></li>
                  <li><a href='#install_bundler'>install_bundler</a></li>
                  <li><a href='#install_chrome'>install_chrome</a></li>
                  <li><a href='#install_firefox'>install_firefox</a></li>
                  <li><a href='#install_git'>install_git</a></li>
                  <li><a href='#install_github_for_mac'>install_github_for_mac</a></li>
                  <li><a href='#install_gpg'>install_gpg</a></li>
                  <li><a href='#install_heroku_toolbelt'>install_heroku_toolbelt</a></li>
                  <li><a href='#install_homebrew'>install_homebrew</a></li>
                  <li><a href='#install_iterm2'>install_iterm2</a></li>
                  <li><a href='#install_node'>install_node</a></li>
                  <li><a href='#install_phantomjs'>install_phantomjs</a></li>
                  <li><a href='#install_postgresql'>install_postgresql</a></li>
                  <li><a href='#install_python3'>install_python3</a></li>
                  <li><a href='#install_qt'>install_qt</a></li>
                  <li><a href='#install_ruby'>install_ruby</a></li>
                  <li><a href='#install_textmate'>install_textmate</a></li>
                  <li><a href='#install_virtualenv'>install_virtualenv</a></li>
                  <li><a href='#npm_install'>npm_install</a></li>
                  <li><a href='#pip_install'>pip_install</a></li>
                  <li><a href='#reboot_vm'>reboot_vm</a></li>
                  <li><a href='#virtualenv_create'>virtualenv_create</a></li>
                </ul>
              </li>
            </ul>
          </nav>

          <nav>
            <h1>Developer Guide</h1>
            <ul>
              <li><a href='#Source Installation'>Source Installation</a></li>
              <li><a href='#Directories and Files'>Directories and Files</a></li>
              <li><a href='#Classes'>Classes</a></li>
              <li><a href='#Adding a Product'>Adding a Product</a></li>
              <li>
                <a href='#API Reference'>API Reference</a>
                <ul>
                  <li><a href='#copy_host_file_to_vm'>copy_host_file_to_vm</a></li>
                  <li><a href='#dmg_install'>dmg_install</a></li>
                  <li><a href='#pkg_install'>pkg_install</a></li>
                  <li><a href='#run_script'>run_script</a></li>
                  <li><a href='#say'>say</a></li>
                  <li><a href='#tar_install'>tar_install</a></li>
                  <li><a href='#zip_install'>zip_install</a></li>
                </ul>
              </li>
            </ul>
          </nav>
        </section>

        <section class='main'>
          <article>
            <h1>vm_provisioner</h1>
            <p class='tagline'>
              A Vagrantfile helper that does very basic virtual machine provisioning.
            </p>
          </article>

          <article>
            <h2><a id='Overview'>Overview</a></h2>
            <p>
              vm_provisioner is a small provisioning helper
              for use with <a href='http://www.vagrantup.com'>Vagrant</a>.
              It is a simplistic version of tools such as
              <a href='http://puppetlabs.com'>Puppet</a>,
              <a href='https://www.getchef.com/'>Chef</a>,
              <a href='http://www.ansible.com'>Ansible</a>,
              <a href='http://en.wikipedia.org/wiki/Comparison_of_open-source_configuration_management_software'>etc.</a>
              It was created as an exercise to learn Vagrant
              and to aid the (re)creation of
              <a href='http://www.apple.com/osx/'>OSX</a>-based
              development environments.
            </p>
            <p>
              Here is a fragment of a Vagrantfile showing how
              vm_provisioner is typically used:
            </p>
<pre>
...

Vagrant.configure(API_VERSION) do |vagrant_config|

  vagrant_config.vm.box = BOX

  vagrant_config.vm.provider(PROVIDER_NAME) do |vb|
    vb.name = VM_NAME
    vb.gui = true
  end

  with vagrant_config do
    install_atom
    install_iterm2
    install_gpg
    install_git
    install_github_for_mac
    install_homebrew
    install_ruby '2.1.2'
    install_bundler
    git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
    cd PROJECT_VM_DIR do
      bundle_install
    end
    reboot_vm
  end

end

...
</pre>
          </article>

          <article>
            <h2><a id='Installation'>Installation</a></h2>
            <p>
              vm_provisioner will install itself each time
              Vagrant runs a Vagrantifile that references it.
              However, these are the prerequisits for using it:
            </p>
            <ul>
              <li><a href='http://www.vagrantup.com'>Vagrant</a> must be installed on the host machine.</li>
              <li><a href='http://www.apple.com/osx/'>OS X</a> must be the operating system running on the virtual machine.</li>
              <li>The <a href='https://developer.apple.com/library/ios/technotes/tn2339/_index.html'>OS X Command Line Tools</a> should be installed on the virtual machine.</li>
              <li>The host machine must have access to <a href='https://github.com'>github.com</a> when Vagrant runs.</li>
            </ul>
          </article>

          <article>
            <h2><a id='Quickstart'>Quickstart</a></h2>
            <ol>
              <li>
                Create and cd into a directory for a new project:
<pre>
$ mkdir -p ~/work/demo
$ cd ~/work/demo
</pre>
              </li>
              <li>
                Create a <a href='https://docs.vagrantup.com/v2/vagrantfile/index.html'>Vagrantfile</a> containing the following:
<pre>
#
# Vagrantfile to create demo development environment.
#

# TODO: annotate
API_VERSION     = "2"
BOX             = "OSX109"
PROVIDER_NAME   = "vmware_fusion"
PROJECT_NAME    = "demo"
VM_NAME         = PROJECT_NAME
PROJECT_VM_DIR  = "/Users/vagrant/Documents/#{PROJECT_NAME}"
PROVISIONER_URL = "https://raw.githubusercontent.com/milewdev/vm-provisioner/v2/Provisioner.rb"


Vagrant.configure(API_VERSION) do |vagrant_config|

  vagrant_config.vm.box = BOX

  vagrant_config.vm.provider(PROVIDER_NAME) do |vb|
    vb.name = VM_NAME
    vb.gui = true
  end

  with vagrant_config do
    install_atom
    install_iterm2
    install_git
    install_github_for_mac
    install_homebrew          # needed to install ruby
    install_ruby '2.1.2'
    install_bundler
    reboot_vm
  end

end


def with(vagrant_config, &block)
  require "open-uri"
  File.write "Provisioner.rb", open(PROVISIONER_URL).read
  require_relative "Provisioner"
  Provisioner.provision(vagrant_config, &block)
  File.delete "Provisioner.rb"
end
</pre>
              </li>
              <li>
                Run <a href='https://docs.vagrantup.com/v2/cli/up.html'>vagrant up</a>:
                <pre>$ vagrant up --provider=vmware_fusion</pre>
              </li>
              <li>See the <a href='#Reference'>Reference</a> for a list of
              currently supported installers.  See <a href='#Ading a
              Product'>Adding a Product</a> for instructions on how to add an
              installer.</li>
            </ol>
          </article>

          <article>
            <h2><a id='Reference'>Reference</a></h2>
            <h3><a id='add_to_path'>add_to_path <i>path</i></a></h3>
            <p>
              Prepend <i>path</i> to the PATH environment variable by doing:
            </p>
            <pre>echo 'export PATH=path:$PATH' >> ~/.bash_profile</pre>
            <p>
              For example, say you have installed nodejs, installed your project,
              and you have run npm install to install any dependencies.  Any nodejs
              binaries, such as grunt, are now located in node_modules/.bin.  So,
              you can add node_modules/.bin to your path:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  install_node
  git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
  cd PROJECT_VM_DIR do
    npm_install
  end
  <b>add_to_path "#{PROJECT_VM_DIR}/node_modules/.bin"</b>
end
</pre>
            <p>
              Now, rather than having to do:
            </p>
            <pre>$ node_modules/.bin/grunt ...</pre>
            <p>
              you can just do:
            </p>
            <pre>$ grunt ...</pre>
          </article>

          <article>
            <h3><a id='bundle_install'>bundle_install</a></h3>
            <p>
              Run <i>bundle install</i>.  <a href='#install_bundler'>bundler</a>
              must be installed beforehand.
            </p>
            <p>
              You would typically install the project sources and then run
              bundle install to install any project dependencies.  Note that
              bundle install is run in the current directory so you will
              likely want to change to the project directory directory first:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  install_homebrew
  install_ruby '2.1.2'
  install_bundler
  git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
  cd PROJECT_VM_DIR do
    <b>bundle_install</b>
  end
end
</pre>
          </article>

          <article>
            <h3><a id='cd'>cd <i>path</i> do ... end</a></h3>
            <p>
              Temporarily change to directory <i>path</i>.  For example,
              you might do this before running bundle_install or
              npm_install:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  install_homebrew
  install_ruby '2.1.2'
  install_bundler
  install_node
  git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
  <b>cd PROJECT_VM_DIR do</b>
    bundle_install
    npm_install
  <b>end</b>
end
</pre>
          </article>

          <article>
            <h3><a id='git_clone'>git_clone <i>git_repository</i>, <i>path</i></a></h3>
            <p>
              Clone <i>git_repository</i> to <i>path</i>. Use this command to
              install project source code from a git repository onto the virtual
              machine:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  <b>git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_atom'>install_atom</a></h3>
            <p>Install the <a href='https://atom.io'>atom</a> editor.</p>
<pre>
with vagrant_config do
  <b>install_atom</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_bundler'>install_bundler</a></h3>
            <p>
              Install the <a href='http://bundler.io'>bundler</a> Ruby gem
              package manager.  <a href='#install_ruby'>Ruby</a> must be
              installed beforehand.
            </p>
<pre>
with vagrant_config do
  install_homebrew
  install_ruby '2.1.2'
  <b>install_bundler</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_chrome'>install_chrome</a></h3>
            <p>
              Install the <a href='http://www.google.com/chrome/'>
              Google Chrome web browser</a>.
            </p>
<pre>
with vagrant_config do
  <b>install_chrome</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_firefox'>install_firefox</a></h3>
            <p>
              Install the <a href='https://mozilla.org/firefox'>
              Mozilla Firefox web browser</a>.
            </p>
<pre>
with vagrant_config do
  <b>install_firefox</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_git'>install_git <i>[version]</i></a></h3>
            <p>
              Install <a href='http://git-scm.com'>git</a>.  Also copy the
              file ~/.gitconfig on the host machine to /Users/vagrant/.gitconfig
              on the virtual machine.  If the optional version parameter is not
              provided, version '2.0.1' is installed.
            </p>
<pre>
with vagrant_config do
  <b>install_git '2.2.0'</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_github_for_mac'>install_github_for_mac</a></h3>
            <p>
              Install the <a href='https://mac.github.com'>GitHub for Mac</a>
              git client.
            </p>
<pre>
with vagrant_config do
  <b>install_github_for_mac</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_gpg'>install_gpg</a></h3>
            <p>
              Install the <a href='https://www.gnupg.org'>gpg</a> encryption
              tools.  Also copy the following files from ~/.gnupg on the host
              machine to /Users/vagrant/.gnupg on the virtual machine: pubring.gpg,
              secring.gpg, trustdb.gpg, pubring.gpg~, and random_seed.
            </p>
<pre>
with vagrant_config do
  <b>install_gpg</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_heroku_toolbelt'>install_heroku_toolbelt</a></h3>
            <p>
              Install <a href='https://toolbelt.heroku.com'>heroku toolbelt</a>,
              the <a href='https://www.heroku.com'>Heroku</a> command line
              utility.
            </p>
<pre>
with vagrant_config do
  <b>install_heroku_toolbelt</b>
end
</pre>
          </article>

          <article>
            <h3><a id='homebrew'>homebrew</a></h3>
            <p>
              Install the <a href='http://brew.sh'>Homebrew</a> OS X package
              manager. The <a
              href='https://developer.apple.com/library/ios/technotes/tn2339/_index.html'>OS
              X command line tools</a> must be installed beforehand on the base
              Vagrant <a
              href='https://docs.vagrantup.com/v2/boxes.html'>box</a>.  During
              installation, homebrew/versions and homebrew/dupes are <a
              href='https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/brew-tap.md'>
              tap</a>ped.
            </p>
            <p>
              Homebrew is a prerequisit for other vm_provisioner tasks,
              such as <a href='#install_ruby'>install_ruby</a>.
            </p>
<pre>
with vagrant_config do
  <b>install_homebrew</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_iterm2'>install_iterm2</a></h3>
            <p>
              Install the <a href='http://iterm2.com'>iterm2</a> OS X terminal
              replacement.
            </p>
<pre>
with vagrant_config do
  <b>install_iterm2</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_node'>install_node <i>[version]</i></a></h3>
            <p>
              Install <a href=''>Node.js</a>.  If the optional version parameter
              is not provided, version 'v0.10.32' is installed.
            </p>
<pre>
with vagrant_config do
  <b>install_node 'v0.10.33'</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_phantomjs'>install_phantomjs</a></h3>
            <p>
              Install the <a href='http://phantomjs.org'>PhantomJS</a> headless
              browser.  <a href='#homebrew'>Homebrew</a> must be installed
              beforehand.
            </p>
<pre>
with vagrant_config do
  install_homebrew
  <b>install_phantomjs</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_postgresql'>install_postgresql <i>[version]</i></a></h3>
            <p>
              Install the <a href='http://www.postgresql.org'>PostgreSQL</a>
              database management system.  If the optional version parameter is
              not supplied, the latest version is installed.  <a
              href='#homebrew'>Homebrew</a> must be installed beforehand. During
              installation <a
              href='http://www.postgresql.org/docs/9.3/static/app-initdb.html'>initdb</a>
              will be called, and the database will be set up to start when user
              <i>vagrant</i> logs in.
            </p>
<pre>
with vagrant_config do
  install_homebrew
  <b>install_postgresql '92'</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_python3'>install_python3</a></h3>
            <p>
              Install <a href='https://www.python.org'>python</a> (v3.4.1).
            </p>
<pre>
with vagrant_config do
  <b>install_python3</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_qt'>install_qt</a></h3>
            <p>
              Install <a href='http://qt-project.org'>qt</a>. <a
              href='#homebrew'>Homebrew</a> must be installed beforehand.
            </p>
<pre>
with vagrant_config do
  install_homebrew
  <b>install_qt</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_ruby'>install_ruby <i>[version]</i></a></h3>
            <p>
              Install <a href='https://www.ruby-lang.org/en/'>Ruby</a>.  If the
              optional version parameter is not supplied, version '2.1.2' is
              installed.  <a href='#homebrew'>Homebrew</a> must be installed
              beforehand.  During installation, <a
              href='https://gcc.gnu.org'>GCC</a> 4.2, <a
              href='https://github.com/sstephenson/rbenv'>rbenv</a>, and <a
              href='https://github.com/sstephenson/ruby-build'>ruby-build</a>
              are also installed.
            </p>
<pre>
with vagrant_config do
  install_homebrew
  <b>install_ruby '2.1.5'</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_textmate'>install_textmate</a></h3>
            <p>
              Install the <a href='http://macromates.com'>TextMate</a> editor.
            </p>
<pre>
with vagrant_config do
  <b>install_textmate</b>
end
</pre>
          </article>

          <article>
            <h3><a id='install_virtualenv'>install_virtualenv</a></h3>
            <p>
              Install <a
              href='https://virtualenv.readthedocs.org/en/latest/'>virtualenv</a>
              (v1.11.6), the Python environment manager.
            </p>
<pre>
with vagrant_config do
  <b>install_virtualenv</b>
end
</pre>
          </article>

          <article>
            <h3><a id='npm_install'>npm_install</a></h3>
            <p>
              Run <i>npm install</i>.  <a href='#install_node'>Node.js</a>
              must be installed beforehand.
            </p>
            <p>
              You would typically install the project sources and then run npm
              install to install any project dependencies.  Note that npm
              install is run in the current directory so you will likely want
              to change to the project directory directory first:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  install_node
  git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
  cd PROJECT_VM_DIR do
    <b>npm_install</b>
  end
end
</pre>
          </article>

          <article>
            <h3><a id='pip_install'>pip_install</a></h3>
            <p>
              Run <i>pip install</i>.  <a href='#install_python3'>Python</a>
              must be installed beforehand.
            </p>
            <p>
              You would typically install the project sources and then run pip
              install to install any project dependencies.  Note that pip
              install is run in the current directory so you will likely want
              to change to the project directory directory first:
            </p>
<pre>
PROJECT_GITHUB_URL = 'https://https://github.com/...'
PROJECT_VM_DIR = '/Users/vagrant/Documents/...'
...
with vagrant_config do
  install_git
  install_python3
  git_clone PROJECT_GITHUB_URL, PROJECT_VM_DIR
  cd PROJECT_VM_DIR do
    <b>pip_install</b>
  end
end
</pre>
          </article>

          <article>
            <h3><a id='reboot_vm'>reboot_vm</a></h3>
            <p>
              Reboot the virtual machine.  This can be a useful last
              provisioning step to ensure that the virtual machine
              boots properly, etc.
            </p>
<pre>
with vagrant_config do
  install_git
  install_homebrew
  install_postgresql
  # ...
  <b>reboot_vm</b>
end
</pre>
          </article>

          <article>
            <h3><a id='virtualenv_create'>virtualenv_create</a></h3>
            <p>
              Use virtualenv to create a python3 <i>env</i> environment.
              <a href='#install_virtualenv'>virtualenv</a> must be installed
              beforehand.
            </p>
<pre>
with vagrant_config do
  install_virtualenv
  <b>virtualenv_create</b>
end
</pre>
          </article>

          <article>
            <h2><a id='Source Installation'>Source Installation</a></h2>
            <p>
            </p>
          </article>

          <article>
            <h2><a id='Directories and Files'>Directories and Files</a></h2>
            <p>
            </p>
          </article>

          <article>
            <h2><a id='Classes'>Classes</a></h2>
            <p>
            </p>
          </article>

          <article>
            <h2><a id='Adding a Product'>Adding a Product</a></h2>
            <p>
            </p>
          </article>

          <article>
            <h2><a id='API Reference'>API Reference</a></h2>
            <h3><a id='copy_host_file_to_vm'>copy_host_file_to_vm</a></h3>
            <p>
            </p>
<pre>
</pre>
          </article>

          <article>
            <h3><a id=''></a></h3>
            <p>
            </p>
<pre>
</pre>
          </article>
        </section>
      </div>
    </div>

    <footer>
      <section>
        <p>
          &copy; 2014 Michael Lewandowski
        </p>
        <p>
          Hosted on <a href='https://pages.github.com'>GitHub Pages</a>
        </p>
      </section>
    </footer>
  </body>
</html>
